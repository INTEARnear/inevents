{
    "id": "socialdb_index",
    "description": "Fired when an index is updated in the social database.",
    "category": "SocialDB",
    "sql_insert": "INSERT INTO socialdb_index (timestamp, transaction_id, receipt_id, block_height, account_id, index_type, index_key, index_value) SELECT to_timestamp((value->>'block_timestamp_nanosec')::bigint / 1000000000.0), value->>'transaction_id', value->>'receipt_id', (value->>'block_height')::bigint, value->>'account_id', value->>'index_type', value->>'index_key', value->>'index_value' FROM jsonb_array_elements($1);",
    "endpoints": [
        {
            "route": "socialdb_index/newest",
            "query": "SELECT json_build_object('id', id, 'timestamp', timestamp, 'transaction_id', transaction_id, 'receipt_id', receipt_id, 'block_height', block_height, 'account_id', account_id, 'index_type', index_type, 'index_key', index_key, 'index_value', index_value) FROM socialdb_index WHERE (($1->>'before_id')::bigint IS NULL OR id < ($1->>'before_id')::bigint) ORDER BY id DESC LIMIT 50;",
            "openapi": null
        },
        {
            "route": "socialdb_index/oldest",
            "query": "SELECT json_build_object('id', id, 'timestamp', timestamp, 'transaction_id', transaction_id, 'receipt_id', receipt_id, 'block_height', block_height, 'account_id', account_id, 'index_type', index_type, 'index_key', index_key, 'index_value', index_value) FROM socialdb_index WHERE (($1->>'after_id')::bigint IS NULL OR id > ($1->>'after_id')::bigint) ORDER BY id ASC LIMIT 50;",
            "openapi": null
        },
        {
            "route": "socialdb_index/by_account",
            "query": "SELECT json_build_object('id', id, 'timestamp', timestamp, 'transaction_id', transaction_id, 'receipt_id', receipt_id, 'block_height', block_height, 'account_id', account_id, 'index_type', index_type, 'index_key', index_key, 'index_value', index_value) FROM socialdb_index WHERE account_id = ($1->>'account_id') AND (($1->>'before_id')::bigint IS NULL OR id < ($1->>'before_id')::bigint) ORDER BY id DESC LIMIT 50;",
            "openapi": null
        },
        {
            "route": "socialdb_index/by_index_type",
            "query": "SELECT json_build_object('id', id, 'timestamp', timestamp, 'transaction_id', transaction_id, 'receipt_id', receipt_id, 'block_height', block_height, 'account_id', account_id, 'index_type', index_type, 'index_key', index_key, 'index_value', index_value) FROM socialdb_index WHERE index_type = ($1->>'index_type') AND (($1->>'before_id')::bigint IS NULL OR id < ($1->>'before_id')::bigint) ORDER BY id DESC LIMIT 50;",
            "openapi": null
        }
    ]
} 